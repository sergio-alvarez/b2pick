window.B2pick={Models:{},Collections:{},Views:{},Routers:{},mapChannel:Backbone.Radio.channel("map"),sidebarChannel:Backbone.Radio.channel("sidebar"),init:function(){"use strict";var a=new B2pick.Views.App;a.setElement($(".js-application")),a.render()}},$(document).ready(function(){"use strict";B2pick.init()}),this.JST=this.JST||{},Handlebars.registerPartial("empty_collection_placeholder",Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="placeholder">\n  <p class="placeholder__text">Hey! You haven\'t any bounding boxes yet. Why not start using the map on the right for drawing some beautiful boxes? <i class="fa fa-smile-o"></i></p>\n</div>\n'})),this.JST["app/scripts/templates/app.hbs"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="sidebar full-column full-column--sidebar js-sidebar"></div>\n<div class="full-column full-column--map js-map"></div>\n'}),this.JST["app/scripts/templates/bounding_box.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div class="bounding-box__actions">\n   <div class="bounding-box__actions__item">\n     <i class="fa fa-trash-o js-remove"></i> \n   </div>\n</div>\n<div class="bounding-box__information">\n  <div class="js-name-wrapper"></div>\n  <p class="bounding-box__coordinates">\n    <i class="fa fa-twitter bounding-box__coordinates__icon icon--twitter"></i>\n    ',(g=c.southWestLongitude)?f=g.call(b,{hash:{},data:e}):(g=b&&b.southWestLongitude,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+",",(g=c.southWestLatitude)?f=g.call(b,{hash:{},data:e}):(g=b&&b.southWestLatitude,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+",",(g=c.northEastLongitude)?f=g.call(b,{hash:{},data:e}):(g=b&&b.northEastLongitude,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+",",(g=c.northEastLatitude)?f=g.call(b,{hash:{},data:e}):(g=b&&b.northEastLatitude,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"\n  </p>\n</div>\n"}),this.JST["app/scripts/templates/bounding_box_collection.hbs"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div>\n  <p class="sidebar__section__actions">\n    <a href="#" class="js-download button">Download</a>\n    <a href="#" class="js-back button">Go back</a>\n  </p>\n</div>\n\n<div class="js-bounding-boxes">\n</div>\n'}),this.JST["app/scripts/templates/bounding_box_collection_download.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n<div class="download-type">\n  <h3 class="download-type__title"><i class="fa fa-twitter icon--twitter"></i> Twitter Streaming API</h3>\n  <pre class="code-block code-block--inline">',(e=c.twitter)?d=e.call(a,{hash:{},data:b}):(e=a&&a.twitter,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'</pre>\n</div>\n\n<div class="download-type">\n  <h3 class="download-type__title">JSON</h3>\n  <pre class="code-block">',(e=c.json)?d=e.call(a,{hash:{},data:b}):(e=a&&a.json,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+"</pre>\n</div>\n"}function g(a,b){var e,f="";return f+="\n",e=l.invokePartial(d.empty_collection_placeholder,"empty_collection_placeholder",a,c,d,b),(e||0===e)&&(f+=e),f+="\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var h,i="",j="function",k=this.escapeExpression,l=this;return h=c["if"].call(b,b&&b.hasBoundingBoxes,{hash:{},inverse:l.program(3,g,e),fn:l.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i+="\n"}),this.JST["app/scripts/templates/bounding_box_collection_index.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){return'\n<ul class="js-collection"></ul>\n'}function g(a,b){var e,f="";return f+="\n",e=j.invokePartial(d.empty_collection_placeholder,"empty_collection_placeholder",a,c,d,b),(e||0===e)&&(f+=e),f+="\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var h,i="",j=this;return h=c["if"].call(b,b&&b.hasBoundingBoxes,{hash:{},inverse:j.program(3,g,e),fn:j.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i+="\n"}),this.JST["app/scripts/templates/bounding_box_edition_name.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div>\n  <input type="text" class="js-name-input bounding-box__input" value="',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\n</div>\n'}),this.JST["app/scripts/templates/bounding_box_regular_name.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<p class="bounding-box__name">\n  <span class="js-name editable-text">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"</span>\n</p>\n"}),this.JST["app/scripts/templates/map.hbs"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="js-map-canvas map"></div>\n'}),this.JST["app/scripts/templates/sidebar.hbs"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<header>\n  <h1 class="sidebar__title">b2pick</h1>\n  <p class="sidebar__subtitle">Picking Bouding Boxes in an easy manner</p>\n\n  <div class="social">\n    <a\n      href="https://twitter.com/share"\n      class="twitter-share-button"\n      data-url="https://sergio-alvarez.github.io/b2pick"\n      data-via="varezHH">Tweet</a>\n    <script>\n    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?\'http\':\'https\';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+\'://platform.twitter.com/widgets.js\';fjs.parentNode.insertBefore(js,fjs);}}(document, \'script\', \'twitter-wjs\');\n    </script>\n\n    <iframe\n      src="https://ghbtns.com/github-btn.html?user=sergio-alvarez&repo=b2pick&type=star&count=true"\n      frameborder="0"\n      scrolling="0"\n      width="100px"\n      height="20px">\n    </iframe>\n  </div>\n</header>\n<section class="sidebar__section">\n  <div class="js-bounding-box-collection"></div>\n</section>\n'}),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.Sidebar=Backbone.View.extend({template:JST["app/scripts/templates/sidebar.hbs"],initialize:function(){this.boundingBoxCollection=new B2pick.Collections.BoundingBox,B2pick.mapChannel.reply("map:newBoundingBox",this.onNewBoundingBox())},onNewBoundingBox:function(){var a=this;return function(b){var c=B2pick.Models.BoundingBox.buildFromGoogleRectangle(b);return a.boundingBoxCollection.add(c),c}},renderBoundingBoxesCollectionView:function(){new B2pick.Views.BoundingBoxCollection({collection:this.boundingBoxCollection}).setElement($(".js-bounding-box-collection")).render()},render:function(){this.$el.html(this.template()),this.renderBoundingBoxesCollectionView()}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.App=Backbone.View.extend({template:JST["app/scripts/templates/app.hbs"],events:{},renderSidebar:function(){(new B2pick.Views.Sidebar).setElement(this.$(".js-sidebar")).render()},renderMap:function(){(new B2pick.Views.Map).setElement(this.$(".js-map")).render()},render:function(){this.$el.html(this.template()),this.renderSidebar(),this.renderMap()}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.Map=Backbone.View.extend({template:JST["app/scripts/templates/map.hbs"],mapOptions:{center:{lat:43.3694869,lng:-5.8486578},zoom:4},drawingManagerOptions:{drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.RECTANGLE]}},initialize:function(){this.map=null,this.drawingManager=null},onRectangleComplete:function(){var a=this;return function(b){var c=B2pick.mapChannel.request("map:newBoundingBox",b);a.listenTo(c,"removeMe",a.onRemoveBoundingBox),a.boundingBoxRectangles=a.boundingBoxRectangles||[],a.boundingBoxRectangles.push({boundingBox:c,rectangle:b})}},onRemoveBoundingBox:function(a){var b=_.find(this.boundingBoxRectangles,function(b){return b.boundingBox.cid===a.cid});b.rectangle.setMap(null)},renderMapCanvas:function(){var a=this.$(".js-map-canvas");this.map=new google.maps.Map(a[0],this.mapOptions),this.drawingManager=new google.maps.drawing.DrawingManager(this.drawingManagerOptions),this.drawingManager.setMap(this.map),google.maps.event.addListener(this.drawingManager,"rectanglecomplete",this.onRectangleComplete())},render:function(){this.$el.html(this.template()),this.renderMapCanvas()}})}(),B2pick.Models=B2pick.Models||{},function(){"use strict";B2pick.Models.BoundingBox=Backbone.Model.extend({defaults:{name:"Bounding box"}},{buildFromGoogleRectangle:function(a){var b={southWestLatitude:a.getBounds().getSouthWest().lat(),southWestLongitude:a.getBounds().getSouthWest().lng(),northEastLatitude:a.getBounds().getNorthEast().lat(),northEastLongitude:a.getBounds().getNorthEast().lng()};return new B2pick.Models.BoundingBox(b)}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBoxCollection=Backbone.View.extend({STATUS:{INDEX:"index",DOWNLOAD:"download"},template:JST["app/scripts/templates/bounding_box_collection.hbs"],events:{"click .js-download":"onDownload","click .js-back":"onBack"},onDownload:function(a){a.preventDefault(),this._status=this.STATUS.DOWNLOAD,this.renderBoundingBoxesView("Download"),this.renderActions()},onBack:function(a){a.preventDefault(),this._status=this.STATUS.INDEX,this.renderBoundingBoxesView("Index"),this.renderActions()},initialize:function(){this._boundingBoxesView=null,this._status=this.STATUS.INDEX},renderActions:function(){var a=this.$(".js-download"),b=this.$(".js-back");a.toggleClass("button--hidden",this._status!==this.STATUS.INDEX),b.toggleClass("button--hidden",this._status!==this.STATUS.DOWNLOAD)},renderBoundingBoxesView:function(a){this._boundingBoxesView&&(this._boundingBoxesView.undelegateEvents(),this._boundingBoxesView.stopListening());var b=B2pick.Views["BoundingBoxCollection"+a];this._boundingBoxesView=new b({collection:this.collection}),this._boundingBoxesView.setElement(this.$(".js-bounding-boxes")),this._boundingBoxesView.render()},render:function(){return this.$el.html(this.template()),this.renderBoundingBoxesView("Index"),this.renderActions(),this.$el}})}(),B2pick.Collections=B2pick.Collections||{},function(){"use strict";B2pick.Collections.BoundingBox=Backbone.Collection.extend({model:B2pick.Models.BoundingBox,initialize:function(){this.on("removeMe",this.onRemoveBoundingBox)},onRemoveBoundingBox:function(a){this.remove(a)}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBox=Backbone.View.extend({template:JST["app/scripts/templates/bounding_box.hbs"],tagName:"li",className:"bounding-box",events:{"click .js-remove":"onRemoveClick"},initialize:function(){this.currentNameView=null,this.listenTo(this.model,"editName",this.onEditBoundingBoxName),this.listenTo(this.model,"saveName",this.onSaveBoundingBoxName)},onRemoveClick:function(a){a.preventDefault(),this.model.trigger("removeMe",this.model)},onEditBoundingBoxName:function(){this.clearNameWrapper(),this.renderNameView("Edition")},onSaveBoundingBoxName:function(){this.clearNameWrapper(),this.renderNameView("Regular")},clearNameWrapper:function(){this.$(".js-name-wrapper").empty(),this.currentNameView.undelegateEvents(),this.currentNameView.stopListening()},formatCoordinate:function(a){return a.toFixed(2)},renderNameView:function(a){var b="BoundingBox"+a+"Name";this.currentNameView=new B2pick.Views[b]({model:this.model}),this.currentNameView.setElement(this.$(".js-name-wrapper")).render()},viewAttributes:function(){return{northEastLatitude:this.formatCoordinate(this.model.get("northEastLatitude")),northEastLongitude:this.formatCoordinate(this.model.get("northEastLongitude")),southWestLatitude:this.formatCoordinate(this.model.get("southWestLatitude")),southWestLongitude:this.formatCoordinate(this.model.get("southWestLongitude"))}},render:function(){return this.delegateEvents(),this.$el.html(this.template(this.viewAttributes())),this.renderNameView("Regular"),this.$el}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBoxRegularName=Backbone.View.extend({template:JST["app/scripts/templates/bounding_box_regular_name.hbs"],events:{"click .js-name":"onEditNameClick"},onEditNameClick:function(a){a.preventDefault(),this.model.trigger("editName")},render:function(){this.$el.html(this.template({name:this.model.get("name")}))}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBoxEditionName=Backbone.View.extend({ENTER_KEY_CODE:13,template:JST["app/scripts/templates/bounding_box_edition_name.hbs"],events:{"keypress .js-name-input":"onNameInputKeyPress"},onNameInputKeyPress:function(a){var b=a.keyCode;b===this.ENTER_KEY_CODE&&this.save()},save:function(){var a=this.$(".js-name-input").val();this.model.set("name",a),this.model.trigger("saveName")},viewAttributes:function(){return{name:this.model.get("name")}},render:function(){this.$el.html(this.template(this.viewAttributes()));var a=this.$(".js-name-input"),b=a.val().length;return a.focus(),a[0].setSelectionRange(b,b),this.$el}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBoxCollectionIndex=Backbone.View.extend({template:JST["app/scripts/templates/bounding_box_collection_index.hbs"],initialize:function(){this._subviews={},this.listenTo(this.collection,"add remove",this.render)},subviews:function(){var a=this;return this.collection.map(function(b){return a._subviews[b.cid]=a._subviews[b.cid]||new B2pick.Views.BoundingBox({model:b}),a._subviews[b.cid]})},viewAttributes:function(){return{hasBoundingBoxes:!this.collection.isEmpty()}},render:function(){this.$el.html(this.template(this.viewAttributes()));var a=this.$(".js-collection");return a.empty().append(_.invoke(this.subviews(),"render")),this.$el}})}(),B2pick.Views=B2pick.Views||{},function(){"use strict";B2pick.Views.BoundingBoxCollectionDownload=Backbone.View.extend({template:JST["app/scripts/templates/bounding_box_collection_download.hbs"],initialize:function(){this.listenTo(this.collection,"add remove",this.render)},toTwitter:function(){var a=this.collection.chain().map(function(a){return[a.get("southWestLongitude").toFixed(2),a.get("southWestLatitude").toFixed(2),a.get("northEastLongitude").toFixed(2),a.get("northEastLatitude").toFixed(2)]}).flatten().value().join(",");return"&locations="+a},viewAttributes:function(){return{hasBoundingBoxes:!this.collection.isEmpty(),json:JSON.stringify(this.collection,null,2),twitter:this.toTwitter()}},render:function(){return this.$el.html(this.template(this.viewAttributes())),this.$el}})}();